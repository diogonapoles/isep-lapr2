@startuml
autonumber

actor "Coordinator" as COO

participant ":VaccinatedToFileUI" as UI
participant ":VaccinatedToFileController" as CTRL
participant "App" as APP
participant "oApp\n:App" as oApp
participant "vcs\n:VaccinationCenterStore" as VCS
participant "org\n:Organization" as ORG
participant "task\n:Task" as TAREFA
participant "cat\n:Category" as CAT
participant "lc\n:List<Category>" as LIST_CAT

activate COO
COO -> UI : asks export fully vaccinated users to file
activate UI
UI -> CTRL : controller = VaccinatedToFileController()
activate CTRL
CTRL -> APP : app = getInstance()
activate APP
deactivate APP
CTRL -> oApp : company = getCompany()
activate oApp
deactivate oApp

deactivate CTRL

UI --> COO : requests data (fileName)
deactivate UI

COO -> UI : types requested data
activate UI

UI -> CTRL : getListAdministratedVaccines()
activate CTRL

CTRL -> VCS : getListAdministratedVaccines()
activate PLAT
|||
deactivate PLAT
deactivate CTRL

UI --> COO : shows task categories list and ask to select one
deactivate PLAT
deactivate UI

COO -> UI : selects a task category
activate UI

UI -> CTRL : createTask(ref,designation,informalDesc,technicalDesc,duration,cost,categoryId)
activate CTRL

CTRL -> PLAT : cat=getCategoryById(categoryId)
activate PLAT
|||
deactivate PLAT

CTRL -> _APP: app = getInstance()
activate _APP
|||
deactivate _APP

CTRL -> APP: session = getCurrentSession()
activate APP
|||
deactivate APP

CTRL -> SESSAO: email = getUserEmail()
activate SESSAO
|||
deactivate SESSAO

CTRL -> PLAT: org = getOrganizationByUserEmail(email)
activate PLAT
|||
deactivate PLAT

CTRL -> ORG: task=createTask(ref,designation,informalDesc,technicalDesc,duration,cost,cat)
activate ORG

ORG --> TAREFA**: create(ref,designation,informalDesc,technicalDesc,duration,cost,cat)
ORG -> ORG: validateTask(task)

CTRL --> UI: result

UI --> COO: shows all data and requests confirmation
deactivate ORG
deactivate PLAT
deactivate CTRL
deactivate UI

COO -> UI : confirms the data
activate UI
UI -> CTRL : saveTask()
activate CTRL

CTRL -> ORG : saveTask(task)
activate ORG

ORG -> ORG: validateTask(task)
ORG -> ORG: addTask(task)

CTRL --> UI: result

UI --> COO : informs operation success
deactivate ORG
deactivate CTRL
deactivate UI

deactivate COO

@enduml